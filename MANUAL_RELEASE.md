# æ‰‹åŠ¨å‘å¸ƒæŒ‡å—

æœ¬é¡¹ç›®é‡‡ç”¨**æ‰‹åŠ¨è§¦å‘**çš„å‘å¸ƒç­–ç•¥ï¼Œç¡®ä¿å‘å¸ƒè¿‡ç¨‹çš„å¯æ§æ€§å’Œå®‰å…¨æ€§ã€‚

## ğŸ” æ‰‹åŠ¨å‘å¸ƒçš„ä¼˜åŠ¿

- **å¯æ§æ€§**: å®Œå…¨æ§åˆ¶ä½•æ—¶å‘å¸ƒæ–°ç‰ˆæœ¬
- **å®‰å…¨æ€§**: é¿å…æ„å¤–çš„è‡ªåŠ¨å‘å¸ƒ
- **å®¡æŸ¥æ€§**: æ¯æ¬¡å‘å¸ƒéƒ½éœ€è¦äººå·¥ç¡®è®¤
- **çµæ´»æ€§**: å¯ä»¥é€‰æ‹©æœ€ä½³çš„å‘å¸ƒæ—¶æœº

## ğŸ“‹ å‘å¸ƒå‰å‡†å¤‡

### 1. ç¡®ä¿ç¯å¢ƒå‡†å¤‡å°±ç»ª

```bash
# æ£€æŸ¥å·¥ä½œç›®å½•çŠ¶æ€
git status

# ç¡®ä¿åœ¨ main åˆ†æ”¯
git branch --show-current

# è¿è¡Œå‘å¸ƒå‰æ£€æŸ¥
bash scripts/release-check.sh
```

### 2. æ·»åŠ å˜æ›´é›†

```bash
# æ·»åŠ å˜æ›´æè¿°
pnpm changeset
```

æ ¹æ®æ›´æ”¹ç±»å‹é€‰æ‹©ï¼š

- **patch** (0.1.0 â†’ 0.1.1): Bug ä¿®å¤
- **minor** (0.1.0 â†’ 0.2.0): æ–°åŠŸèƒ½
- **major** (0.1.0 â†’ 1.0.0): ç ´åæ€§æ›´æ”¹

### 3. æäº¤å˜æ›´

```bash
git add .
git commit -m "feat: add new feature with changeset"
git push origin main
```

## ğŸš€ æ‰‹åŠ¨è§¦å‘å‘å¸ƒ

### æ–¹å¼ä¸€ï¼šGitHub Web ç•Œé¢ï¼ˆæ¨èï¼‰

1. æ‰“å¼€ GitHub ä»“åº“é¡µé¢
2. ç‚¹å‡» **Actions** æ ‡ç­¾
3. åœ¨å·¦ä¾§æ‰¾åˆ° **Release** å·¥ä½œæµ
4. ç‚¹å‡» **Run workflow** æŒ‰é’®
5. ç¡®è®¤åˆ†æ”¯ä¸º `main`
6. ç‚¹å‡» **Run workflow** å¼€å§‹æ‰§è¡Œ

### æ–¹å¼äºŒï¼šGitHub CLI

```bash
# å®‰è£… GitHub CLIï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
brew install gh

# è®¤è¯
gh auth login

# æ‰‹åŠ¨è§¦å‘å‘å¸ƒå·¥ä½œæµ
gh workflow run release.yml
```

### æ–¹å¼ä¸‰ï¼šAPI è°ƒç”¨

```bash
# ä½¿ç”¨ curl è°ƒç”¨ GitHub API
curl -X POST \
  -H "Authorization: token YOUR_GITHUB_TOKEN" \
  -H "Accept: application/vnd.github.v3+json" \
  https://api.github.com/repos/vivgrid/vivgrid-ai-provider/actions/workflows/release.yml/dispatches \
  -d '{"ref":"main"}'
```

## ğŸ“Š å‘å¸ƒæµç¨‹ç›‘æ§

### æŸ¥çœ‹å·¥ä½œæµçŠ¶æ€

1. åœ¨ GitHub Actions é¡µé¢æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
2. ç‚¹å‡»å…·ä½“çš„å·¥ä½œæµè¿è¡ŒæŸ¥çœ‹è¯¦ç»†æ—¥å¿—
3. ç›‘æ§å„ä¸ªæ­¥éª¤çš„æ‰§è¡Œæƒ…å†µ

### å‘å¸ƒç»“æœç¡®è®¤

å‘å¸ƒæˆåŠŸåï¼Œç³»ç»Ÿä¼šï¼š

- âœ… æ›´æ–° `package.json` ç‰ˆæœ¬å·
- âœ… ç”Ÿæˆæˆ–æ›´æ–° `CHANGELOG.md`
- âœ… åˆ›å»º Git æ ‡ç­¾
- âœ… å‘å¸ƒåˆ° npm ä»“åº“
- âœ… åˆ›å»º GitHub Release

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **NPM_TOKEN æœªé…ç½®**

   ```
   Error: Unable to authenticate with npm
   ```

   è§£å†³ï¼šåœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ  `NPM_TOKEN` secret

2. **æ²¡æœ‰ changeset æ–‡ä»¶**

   ```
   Error: No changeset files found
   ```

   è§£å†³ï¼šè¿è¡Œ `pnpm changeset` æ·»åŠ å˜æ›´é›†

3. **æƒé™ä¸è¶³**
   ```
   Error: Permission denied
   ```
   è§£å†³ï¼šç¡®ä¿æœ‰ä»“åº“å†™å…¥æƒé™å’Œ npm å‘å¸ƒæƒé™

### å›æ»šå‘å¸ƒ

å¦‚æœå‘å¸ƒå‡ºç°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. **npm å›æ»š**: `npm unpublish vivgrid-ai-provider@ç‰ˆæœ¬å·`
2. **Git å›æ»š**: `git revert æäº¤å“ˆå¸Œ`
3. **åˆ é™¤æ ‡ç­¾**: `git tag -d vç‰ˆæœ¬å· && git push origin :refs/tags/vç‰ˆæœ¬å·`

## ğŸ“ æœ€ä½³å®è·µ

1. **å‘å¸ƒå‰æµ‹è¯•**: ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
2. **æ–‡æ¡£æ›´æ–°**: é‡è¦æ›´æ”¹éœ€è¦æ›´æ–°æ–‡æ¡£
3. **å‘å¸ƒè¯´æ˜**: åœ¨ changeset ä¸­è¯¦ç»†æè¿°æ›´æ”¹
4. **ç‰ˆæœ¬ç­–ç•¥**: éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ
5. **å‘å¸ƒæ—¶æœº**: é€‰æ‹©åˆé€‚çš„æ—¶é—´å‘å¸ƒï¼Œé¿å…é«˜å³°æœŸ

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

- å®šæœŸè½®æ¢ NPM_TOKEN
- é™åˆ¶å‘å¸ƒæƒé™ç»™ä¿¡ä»»çš„ç»´æŠ¤è€…
- ç›‘æ§å‘å¸ƒæ—¥å¿—å’Œå¼‚å¸¸
- å¤‡ä»½é‡è¦çš„å‘å¸ƒé…ç½®
